2026-01-07 07:58:40,283 - nanochat.common - [32m[1mINFO[0m - Distributed world size: 1
[STARTUP] GPU memory: 24.87GB free / 25.28GB total

                                                       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                                                      â–‘â–‘â–ˆâ–ˆâ–ˆ                â–‘â–‘â–ˆâ–ˆâ–ˆ
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘
     â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–‘  â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ
     â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ
     â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘
    
Overriding: schema = kubernetes
Overriding: tokenizer = tct
Overriding: model_size = small
Overriding: data_root = /workspace/data
Overriding: dropout = 0.2
Overriding: model_tag = kubernetes_tct_small_drop0.2
Autodetected device type: cuda
================================================================================
EXPERIMENT: kubernetes / tct-BPE / small
================================================================================
Schema: kubernetes
Tokenizer: tct-BPE
Data path: /workspace/data/kubernetes-tct-bpe-1k
Vocab size: 1,000
Context size: 2048
Model size: small (50,324,480 params)
Dropout: 0.2

Batch size: 16
Gradient accumulation: 4
Effective batch size: 64
Learning rate: 4.0000e-04 (cosine decay to 4.0e-05)

Epochs: 150
Steps per epoch: 869
Total steps: 130350
Warmup steps: 43
Save interval: every 13035 steps (10%) (RunPod detected)

Gradient checkpointing: disabled (use --gradient_checkpointing=True if OOM)
Cleared torch inductor cache
Compiling model with torch.compile...
Model compilation complete
Number of parameters: 49,258,496

Initializing dataloaders...
Reshuffling data (combining train+val, random split)...
  Pad token: 999
Loaded 246,439 total sequences from kubernetes-tct-bpe-1k (all.jsonl)
  Reshuffled split: 234,117 train, 12,322 val (seed=42)
First batch shape: x=torch.Size([16, 2048]), y=torch.Size([16, 2048])

================================================================================
STARTING TRAINING
================================================================================

E00 step 000000/130350 (0.0%) | loss: 6.9078 | ppl: 1000.0 | lr: 9.30e-06 | dt: 51436ms | tok/s: 2,548
E00 step 000010/130350 (0.0%) | loss: 6.8699 | ppl: 962.8 | lr: 1.02e-04 | dt: 499ms | tok/s: 262,554
E00 step 000020/130350 (0.0%) | loss: 6.6289 | ppl: 756.6 | lr: 1.95e-04 | dt: 499ms | tok/s: 262,648
E00 step 000030/130350 (0.0%) | loss: 6.3439 | ppl: 569.0 | lr: 2.88e-04 | dt: 500ms | tok/s: 262,214
E00 step 000040/130350 (0.0%) | loss: 6.1410 | ppl: 464.5 | lr: 3.81e-04 | dt: 500ms | tok/s: 262,141
E00 step 000050/130350 (0.0%) | loss: 5.8332 | ppl: 341.4 | lr: 4.00e-04 | dt: 500ms | tok/s: 262,298
E00 step 000060/130350 (0.0%) | loss: 5.5341 | ppl: 253.2 | lr: 4.00e-04 | dt: 500ms | tok/s: 262,043
E00 step 000070/130350 (0.1%) | loss: 5.1523 | ppl: 172.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,858
E00 step 000080/130350 (0.1%) | loss: 4.9257 | ppl: 137.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,806
E00 step 000090/130350 (0.1%) | loss: 4.7224 | ppl: 112.4 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,569
E00 step 000100/130350 (0.1%) | loss: 4.4399 | ppl: 84.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,668
E00 step 000110/130350 (0.1%) | loss: 4.3724 | ppl: 79.2 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,797
E00 step 000120/130350 (0.1%) | loss: 4.3348 | ppl: 76.3 | lr: 4.00e-04 | dt: 500ms | tok/s: 261,935
E00 step 000130/130350 (0.1%) | loss: 4.0905 | ppl: 59.8 | lr: 4.00e-04 | dt: 500ms | tok/s: 261,888
E00 step 000140/130350 (0.1%) | loss: 4.0718 | ppl: 58.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,255
E00 step 000150/130350 (0.1%) | loss: 3.8860 | ppl: 48.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,295
E00 step 000160/130350 (0.1%) | loss: 3.7915 | ppl: 44.3 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,424
E00 step 000170/130350 (0.1%) | loss: 3.7974 | ppl: 44.6 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,445
E00 step 000180/130350 (0.1%) | loss: 3.6179 | ppl: 37.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,202
E00 step 000190/130350 (0.1%) | loss: 3.6150 | ppl: 37.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,157
E00 step 000200/130350 (0.2%) | loss: 3.4482 | ppl: 31.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,035
E00 step 000210/130350 (0.2%) | loss: 3.3151 | ppl: 27.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,280
E00 step 000220/130350 (0.2%) | loss: 3.2287 | ppl: 25.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,959
E00 step 000230/130350 (0.2%) | loss: 3.2070 | ppl: 24.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,152
E00 step 000240/130350 (0.2%) | loss: 3.1798 | ppl: 24.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,028
E00 step 000250/130350 (0.2%) | loss: 3.0048 | ppl: 20.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,118
E00 step 000260/130350 (0.2%) | loss: 3.0063 | ppl: 20.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,028
E00 step 000270/130350 (0.2%) | loss: 3.1409 | ppl: 23.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,997
E00 step 000280/130350 (0.2%) | loss: 2.9206 | ppl: 18.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,315
E00 step 000290/130350 (0.2%) | loss: 2.9280 | ppl: 18.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,028
E00 step 000300/130350 (0.2%) | loss: 2.8688 | ppl: 17.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,264
E00 step 000310/130350 (0.2%) | loss: 2.8188 | ppl: 16.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,276
E00 step 000320/130350 (0.2%) | loss: 2.6807 | ppl: 14.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,169
E00 step 000330/130350 (0.3%) | loss: 2.7243 | ppl: 15.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,354
E00 step 000340/130350 (0.3%) | loss: 2.7530 | ppl: 15.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,352
E00 step 000350/130350 (0.3%) | loss: 2.6125 | ppl: 13.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,225
E00 step 000360/130350 (0.3%) | loss: 2.4901 | ppl: 12.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,220
E00 step 000370/130350 (0.3%) | loss: 2.5662 | ppl: 13.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,293
E00 step 000380/130350 (0.3%) | loss: 2.5698 | ppl: 13.1 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,360
E00 step 000390/130350 (0.3%) | loss: 2.6006 | ppl: 13.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,113
E00 step 000400/130350 (0.3%) | loss: 2.3910 | ppl: 10.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,154
E00 step 000410/130350 (0.3%) | loss: 2.3687 | ppl: 10.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,050
E00 step 000420/130350 (0.3%) | loss: 2.3904 | ppl: 10.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,041
E00 step 000430/130350 (0.3%) | loss: 2.3065 | ppl: 10.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,179
E00 step 000440/130350 (0.3%) | loss: 2.4474 | ppl: 11.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,214
E00 step 000450/130350 (0.3%) | loss: 2.5338 | ppl: 12.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,190
E00 step 000460/130350 (0.4%) | loss: 2.3592 | ppl: 10.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,154
E00 step 000470/130350 (0.4%) | loss: 2.1839 | ppl: 8.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,064
E00 step 000480/130350 (0.4%) | loss: 2.2690 | ppl: 9.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,135
E00 step 000490/130350 (0.4%) | loss: 2.1900 | ppl: 8.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,116
E00 step 000500/130350 (0.4%) | loss: 2.1376 | ppl: 8.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,090
E00 step 000510/130350 (0.4%) | loss: 2.1705 | ppl: 8.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,413
E00 step 000520/130350 (0.4%) | loss: 2.1708 | ppl: 8.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,371
E00 step 000530/130350 (0.4%) | loss: 1.9785 | ppl: 7.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,352
E00 step 000540/130350 (0.4%) | loss: 2.0869 | ppl: 8.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,181
E00 step 000550/130350 (0.4%) | loss: 2.1811 | ppl: 8.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,469
E00 step 000560/130350 (0.4%) | loss: 2.0379 | ppl: 7.7 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,810
E00 step 000570/130350 (0.4%) | loss: 1.9669 | ppl: 7.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,942
E00 step 000580/130350 (0.4%) | loss: 1.9005 | ppl: 6.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,168
E00 step 000590/130350 (0.5%) | loss: 1.9535 | ppl: 7.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,134
E00 step 000600/130350 (0.5%) | loss: 2.2173 | ppl: 9.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,126
E00 step 000610/130350 (0.5%) | loss: 1.9134 | ppl: 6.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,371
E00 step 000620/130350 (0.5%) | loss: 2.0341 | ppl: 7.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,047
E00 step 000630/130350 (0.5%) | loss: 2.0316 | ppl: 7.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,164
E00 step 000640/130350 (0.5%) | loss: 2.0000 | ppl: 7.4 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,366
E00 step 000650/130350 (0.5%) | loss: 2.0485 | ppl: 7.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,237
E00 step 000660/130350 (0.5%) | loss: 2.0431 | ppl: 7.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,188
E00 step 000670/130350 (0.5%) | loss: 1.9745 | ppl: 7.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,180
E00 step 000680/130350 (0.5%) | loss: 1.8732 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,207
E00 step 000690/130350 (0.5%) | loss: 1.8624 | ppl: 6.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,068
E00 step 000700/130350 (0.5%) | loss: 1.9344 | ppl: 6.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,385
E00 step 000710/130350 (0.5%) | loss: 1.9445 | ppl: 7.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,342
E00 step 000720/130350 (0.6%) | loss: 1.8850 | ppl: 6.6 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,501
E00 step 000730/130350 (0.6%) | loss: 1.9314 | ppl: 6.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,358
E00 step 000740/130350 (0.6%) | loss: 1.9042 | ppl: 6.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,296
E00 step 000750/130350 (0.6%) | loss: 1.9377 | ppl: 6.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,457
E00 step 000760/130350 (0.6%) | loss: 1.8856 | ppl: 6.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,215
E00 step 000770/130350 (0.6%) | loss: 1.8787 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,017
E00 step 000780/130350 (0.6%) | loss: 1.8783 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,164
E00 step 000790/130350 (0.6%) | loss: 1.8804 | ppl: 6.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,256
E00 step 000800/130350 (0.6%) | loss: 1.6646 | ppl: 5.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,183
E00 step 000810/130350 (0.6%) | loss: 1.7780 | ppl: 5.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,063
E00 step 000820/130350 (0.6%) | loss: 1.8041 | ppl: 6.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,329
E00 step 000830/130350 (0.6%) | loss: 1.6652 | ppl: 5.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,118
E00 step 000840/130350 (0.6%) | loss: 1.7215 | ppl: 5.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,173
E00 step 000850/130350 (0.7%) | loss: 1.7686 | ppl: 5.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,227
E00 step 000860/130350 (0.7%) | loss: 1.8480 | ppl: 6.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,094
Epoch   1 | Step    869 | Val loss: 1.5784 | Val ppl: 4.85 (best)
E01 step 000870/130350 (0.7%) | loss: 1.7811 | ppl: 5.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,460
E01 step 000880/130350 (0.7%) | loss: 1.6827 | ppl: 5.4 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,468
E01 step 000890/130350 (0.7%) | loss: 1.8382 | ppl: 6.3 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,425
E01 step 000900/130350 (0.7%) | loss: 1.6496 | ppl: 5.2 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,419
E01 step 000910/130350 (0.7%) | loss: 1.6807 | ppl: 5.4 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,549
E01 step 000920/130350 (0.7%) | loss: 1.7735 | ppl: 5.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,367
E01 step 000930/130350 (0.7%) | loss: 1.7157 | ppl: 5.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,346
E01 step 000940/130350 (0.7%) | loss: 1.5441 | ppl: 4.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,078
E01 step 000950/130350 (0.7%) | loss: 1.5744 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,031
E01 step 000960/130350 (0.7%) | loss: 1.5828 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,937
E01 step 000970/130350 (0.7%) | loss: 1.5614 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,968
E01 step 000980/130350 (0.8%) | loss: 1.6214 | ppl: 5.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,031
E01 step 000990/130350 (0.8%) | loss: 1.6373 | ppl: 5.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,095
E01 step 001000/130350 (0.8%) | loss: 1.7564 | ppl: 5.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,224
E01 step 001010/130350 (0.8%) | loss: 1.7763 | ppl: 5.9 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,758
E01 step 001020/130350 (0.8%) | loss: 1.5954 | ppl: 4.9 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,698
E01 step 001030/130350 (0.8%) | loss: 1.6205 | ppl: 5.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,195
E01 step 001040/130350 (0.8%) | loss: 1.5098 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,890
E01 step 001050/130350 (0.8%) | loss: 1.7367 | ppl: 5.7 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,769
E01 step 001060/130350 (0.8%) | loss: 1.5850 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,303
E01 step 001070/130350 (0.8%) | loss: 1.5938 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,170
E01 step 001080/130350 (0.8%) | loss: 1.6183 | ppl: 5.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,915
E01 step 001090/130350 (0.8%) | loss: 1.6571 | ppl: 5.2 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,755
E01 step 001100/130350 (0.8%) | loss: 1.4624 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,903
E01 step 001110/130350 (0.9%) | loss: 1.5602 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,951
E01 step 001120/130350 (0.9%) | loss: 1.4223 | ppl: 4.1 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,697
E01 step 001130/130350 (0.9%) | loss: 1.5869 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,896
E01 step 001140/130350 (0.9%) | loss: 1.5734 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,145
E01 step 001150/130350 (0.9%) | loss: 1.5033 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,001
E01 step 001160/130350 (0.9%) | loss: 1.5498 | ppl: 4.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,876
E01 step 001170/130350 (0.9%) | loss: 1.4615 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,981
E01 step 001180/130350 (0.9%) | loss: 1.5127 | ppl: 4.5 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,800
E01 step 001190/130350 (0.9%) | loss: 1.3494 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,013
E01 step 001200/130350 (0.9%) | loss: 1.5734 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,027
E01 step 001210/130350 (0.9%) | loss: 1.6096 | ppl: 5.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,183
E01 step 001220/130350 (0.9%) | loss: 1.4613 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,875
E01 step 001230/130350 (0.9%) | loss: 1.5245 | ppl: 4.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,862
E01 step 001240/130350 (1.0%) | loss: 1.4897 | ppl: 4.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,056
E01 step 001250/130350 (1.0%) | loss: 1.4468 | ppl: 4.2 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,770
E01 step 001260/130350 (1.0%) | loss: 1.3722 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,272
E01 step 001270/130350 (1.0%) | loss: 1.2615 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,175
E01 step 001280/130350 (1.0%) | loss: 1.2804 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,009
E01 step 001290/130350 (1.0%) | loss: 1.3882 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,145
E01 step 001300/130350 (1.0%) | loss: 1.4897 | ppl: 4.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,249
E01 step 001310/130350 (1.0%) | loss: 1.4483 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,173
E01 step 001320/130350 (1.0%) | loss: 1.2970 | ppl: 3.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,234
E01 step 001330/130350 (1.0%) | loss: 1.4590 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,259
E01 step 001340/130350 (1.0%) | loss: 1.4476 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,223
E01 step 001350/130350 (1.0%) | loss: 1.4397 | ppl: 4.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,120
E01 step 001360/130350 (1.0%) | loss: 1.3976 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,295
E01 step 001370/130350 (1.1%) | loss: 1.4515 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,181
E01 step 001380/130350 (1.1%) | loss: 1.3759 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,279
E01 step 001390/130350 (1.1%) | loss: 1.4667 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,243
E01 step 001400/130350 (1.1%) | loss: 1.5619 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,348
E01 step 001410/130350 (1.1%) | loss: 1.3983 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,148
E01 step 001420/130350 (1.1%) | loss: 1.2650 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,073
E01 step 001430/130350 (1.1%) | loss: 1.3731 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,228
E01 step 001440/130350 (1.1%) | loss: 1.4956 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,242
E01 step 001450/130350 (1.1%) | loss: 1.4324 | ppl: 4.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,076
E01 step 001460/130350 (1.1%) | loss: 1.1916 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,120
E01 step 001470/130350 (1.1%) | loss: 1.1913 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,157
E01 step 001480/130350 (1.1%) | loss: 1.2767 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,234
E01 step 001490/130350 (1.1%) | loss: 1.2473 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,301
E01 step 001500/130350 (1.2%) | loss: 1.3301 | ppl: 3.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,354
E01 step 001510/130350 (1.2%) | loss: 1.3076 | ppl: 3.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,240
E01 step 001520/130350 (1.2%) | loss: 1.3759 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,132
E01 step 001530/130350 (1.2%) | loss: 1.3941 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,237
E01 step 001540/130350 (1.2%) | loss: 1.3655 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,999
E01 step 001550/130350 (1.2%) | loss: 1.3587 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,247
E01 step 001560/130350 (1.2%) | loss: 1.3082 | ppl: 3.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,261
E01 step 001570/130350 (1.2%) | loss: 1.2354 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,978
E01 step 001580/130350 (1.2%) | loss: 1.3906 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,290
E01 step 001590/130350 (1.2%) | loss: 1.2607 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,048
E01 step 001600/130350 (1.2%) | loss: 1.2256 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,094
E01 step 001610/130350 (1.2%) | loss: 1.2376 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,036
E01 step 001620/130350 (1.2%) | loss: 1.0969 | ppl: 3.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,022
E01 step 001630/130350 (1.3%) | loss: 1.2998 | ppl: 3.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,875
E01 step 001640/130350 (1.3%) | loss: 1.4274 | ppl: 4.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,058
E01 step 001650/130350 (1.3%) | loss: 1.3757 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,109
E01 step 001660/130350 (1.3%) | loss: 1.2414 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,093
E01 step 001670/130350 (1.3%) | loss: 1.3656 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,251
E01 step 001680/130350 (1.3%) | loss: 1.2000 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,180
E01 step 001690/130350 (1.3%) | loss: 1.2539 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,213
E01 step 001700/130350 (1.3%) | loss: 1.2988 | ppl: 3.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,148
E01 step 001710/130350 (1.3%) | loss: 1.2296 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,014
E01 step 001720/130350 (1.3%) | loss: 1.2138 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,197
E01 step 001730/130350 (1.3%) | loss: 1.1463 | ppl: 3.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,101
Epoch   2 | Step   1738 | Val loss: 1.1126 | Val ppl: 3.04 (best)
E02 step 001740/130350 (1.3%) | loss: 1.1538 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,904
E02 step 001750/130350 (1.3%) | loss: 1.2278 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,144
E02 step 001760/130350 (1.4%) | loss: 1.3283 | ppl: 3.8 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,809
E02 step 001770/130350 (1.4%) | loss: 1.1794 | ppl: 3.3 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,801
E02 step 001780/130350 (1.4%) | loss: 1.1165 | ppl: 3.1 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,673
E02 step 001790/130350 (1.4%) | loss: 1.1540 | ppl: 3.2 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,721
E02 step 001800/130350 (1.4%) | loss: 1.1728 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,149
E02 step 001810/130350 (1.4%) | loss: 1.2741 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,874
E02 step 001820/130350 (1.4%) | loss: 1.3163 | ppl: 3.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,890
E02 step 001830/130350 (1.4%) | loss: 1.2458 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,263
E02 step 001840/130350 (1.4%) | loss: 1.2769 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,045
E02 step 001850/130350 (1.4%) | loss: 1.3657 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,841
E02 step 001860/130350 (1.4%) | loss: 1.2856 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,298
E02 step 001870/130350 (1.4%) | loss: 1.1280 | ppl: 3.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,289
E02 step 001880/130350 (1.4%) | loss: 1.0561 | ppl: 2.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,200
E02 step 001890/130350 (1.4%) | loss: 1.1199 | ppl: 3.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,944
E02 step 001900/130350 (1.5%) | loss: 1.2262 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,840
E02 step 001910/130350 (1.5%) | loss: 1.0656 | ppl: 2.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,084
E02 step 001920/130350 (1.5%) | loss: 1.1678 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,884
E02 step 001930/130350 (1.5%) | loss: 1.1643 | ppl: 3.2 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,769
E02 step 001940/130350 (1.5%) | loss: 1.2727 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,111
E02 step 001950/130350 (1.5%) | loss: 1.2062 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,153
E02 step 001960/130350 (1.5%) | loss: 1.2012 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,051
E02 step 001970/130350 (1.5%) | loss: 1.2599 | ppl: 3.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,968
E02 step 001980/130350 (1.5%) | loss: 1.1954 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,049
E02 step 001990/130350 (1.5%) | loss: 1.1516 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,030
E02 step 002000/130350 (1.5%) | loss: 1.2285 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,219
E02 step 002010/130350 (1.5%) | loss: 1.1658 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,269
E02 step 002020/130350 (1.5%) | loss: 1.2194 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,192
E02 step 002030/130350 (1.6%) | loss: 1.2198 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,227
E02 step 002040/130350 (1.6%) | loss: 1.0859 | ppl: 3.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,251
E02 step 002050/130350 (1.6%) | loss: 1.0427 | ppl: 2.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,288
E02 step 002060/130350 (1.6%) | loss: 1.1575 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,215
E02 step 002070/130350 (1.6%) | loss: 1.1324 | ppl: 3.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,195
E02 step 002080/130350 (1.6%) | loss: 1.0459 | ppl: 2.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,262
E02 step 002090/130350 (1.6%) | loss: 1.1834 | ppl: 3.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,078
E02 step 002100/130350 (1.6%) | loss: 1.1724 | ppl: 3.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,264
E02 step 002110/130350 (1.6%) | loss: 1.2199 | ppl: 3.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,161
E02 step 002120/130350 (1.6%) | loss: 1.1216 | ppl: 3.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,237
E02 step 002130/130350 (1.6%) | loss: 1.0113 | ppl: 2.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,259
E02 step 002140/130350 (1.6%) | loss: 1.0496 | ppl: 2.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,3032026-01-07 08:20:43,921 - nanochat.common - [32m[1mINFO[0m - Distributed world size: 1
[STARTUP] GPU memory: 24.87GB free / 25.28GB total

                                                       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                                                      â–‘â–‘â–ˆâ–ˆâ–ˆ                â–‘â–‘â–ˆâ–ˆâ–ˆ
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘
     â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–‘  â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ
     â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ
     â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘
    
Overriding: schema = kubernetes
Overriding: tokenizer = tct
Overriding: model_size = small
Overriding: data_root = /workspace/data
Overriding: dropout = 0.2
Overriding: model_tag = kubernetes_tct_small_drop0.2
Autodetected device type: cuda
================================================================================
EXPERIMENT: kubernetes / tct-BPE / small
================================================================================
Schema: kubernetes
Tokenizer: tct-BPE
Data path: /workspace/data/kubernetes-tct-bpe-1k
Vocab size: 1,000
Context size: 2048
Model size: small (50,324,480 params)
Dropout: 0.2

Batch size: 16
Gradient accumulation: 4
Effective batch size: 64
Learning rate: 4.0000e-04 (cosine decay to 4.0e-05)

Epochs: 150
Steps per epoch: 869
Total steps: 130350
Warmup steps: 43
Save interval: every 13035 steps (10%) (RunPod detected)

Gradient checkpointing: disabled (use --gradient_checkpointing=True if OOM)
Cleared torch inductor cache
Compiling model with torch.compile...
Model compilation complete
Number of parameters: 49,258,496

Initializing dataloaders...
Reshuffling data (combining train+val, random split)...
  Pad token: 999
Loaded 246,439 total sequences from kubernetes-tct-bpe-1k (all.jsonl)
  Reshuffled split: 234,117 train, 12,322 val (seed=42)
First batch shape: x=torch.Size([16, 2048]), y=torch.Size([16, 2048])

================================================================================
STARTING TRAINING
================================================================================

E00 step 000000/130350 (0.0%) | loss: 6.9078 | ppl: 1000.0 | lr: 9.30e-06 | dt: 51308ms | tok/s: 2,554
E00 step 000010/130350 (0.0%) | loss: 6.8699 | ppl: 962.8 | lr: 1.02e-04 | dt: 499ms | tok/s: 262,471
E00 step 000020/130350 (0.0%) | loss: 6.6289 | ppl: 756.6 | lr: 1.95e-04 | dt: 500ms | tok/s: 262,355
E00 step 000030/130350 (0.0%) | loss: 6.3439 | ppl: 569.0 | lr: 2.88e-04 | dt: 500ms | tok/s: 262,339
E00 step 000040/130350 (0.0%) | loss: 6.1410 | ppl: 464.5 | lr: 3.81e-04 | dt: 500ms | tok/s: 261,886
E00 step 000050/130350 (0.0%) | loss: 5.8340 | ppl: 341.7 | lr: 4.00e-04 | dt: 500ms | tok/s: 261,945
E00 step 000060/130350 (0.0%) | loss: 5.5375 | ppl: 254.0 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,766
E00 step 000070/130350 (0.1%) | loss: 5.1550 | ppl: 173.3 | lr: 4.00e-04 | dt: 500ms | tok/s: 261,946
E00 step 000080/130350 (0.1%) | loss: 4.9296 | ppl: 138.3 | lr: 4.00e-04 | dt: 500ms | tok/s: 261,990
E00 step 000090/130350 (0.1%) | loss: 4.7276 | ppl: 113.0 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,579
E00 step 000100/130350 (0.1%) | loss: 4.4449 | ppl: 85.2 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,616
E00 step 000110/130350 (0.1%) | loss: 4.3783 | ppl: 79.7 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,603
E00 step 000120/130350 (0.1%) | loss: 4.3380 | ppl: 76.6 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,610
E00 step 000130/130350 (0.1%) | loss: 4.0918 | ppl: 59.8 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,697
E00 step 000140/130350 (0.1%) | loss: 4.0709 | ppl: 58.6 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,501
E00 step 000150/130350 (0.1%) | loss: 3.8855 | ppl: 48.7 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,516
E00 step 000160/130350 (0.1%) | loss: 3.7900 | ppl: 44.3 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,685
E00 step 000170/130350 (0.1%) | loss: 3.7946 | ppl: 44.5 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,615
E00 step 000180/130350 (0.1%) | loss: 3.6168 | ppl: 37.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,335
E00 step 000190/130350 (0.1%) | loss: 3.6131 | ppl: 37.1 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,374
E00 step 000200/130350 (0.2%) | loss: 3.4458 | ppl: 31.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,270
E00 step 000210/130350 (0.2%) | loss: 3.3052 | ppl: 27.3 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,426
E00 step 000220/130350 (0.2%) | loss: 3.2219 | ppl: 25.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,135
E00 step 000230/130350 (0.2%) | loss: 3.2013 | ppl: 24.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,133
E00 step 000240/130350 (0.2%) | loss: 3.1761 | ppl: 24.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,320
E00 step 000250/130350 (0.2%) | loss: 3.0021 | ppl: 20.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,147
E00 step 000260/130350 (0.2%) | loss: 3.0034 | ppl: 20.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,324
E00 step 000270/130350 (0.2%) | loss: 3.1376 | ppl: 23.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,304
E00 step 000280/130350 (0.2%) | loss: 2.9177 | ppl: 18.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,143
E00 step 000290/130350 (0.2%) | loss: 2.9233 | ppl: 18.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,273
E00 step 000300/130350 (0.2%) | loss: 2.8639 | ppl: 17.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,258
E00 step 000310/130350 (0.2%) | loss: 2.8156 | ppl: 16.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,156
E00 step 000320/130350 (0.2%) | loss: 2.6775 | ppl: 14.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,227
E00 step 000330/130350 (0.3%) | loss: 2.7184 | ppl: 15.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,350
E00 step 000340/130350 (0.3%) | loss: 2.7465 | ppl: 15.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,174
E00 step 000350/130350 (0.3%) | loss: 2.6103 | ppl: 13.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,205
E00 step 000360/130350 (0.3%) | loss: 2.4897 | ppl: 12.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,166
E00 step 000370/130350 (0.3%) | loss: 2.5652 | ppl: 13.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,308
E00 step 000380/130350 (0.3%) | loss: 2.5683 | ppl: 13.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,301
E00 step 000390/130350 (0.3%) | loss: 2.5986 | ppl: 13.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,188
E00 step 000400/130350 (0.3%) | loss: 2.3900 | ppl: 10.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,086
E00 step 000410/130350 (0.3%) | loss: 2.3663 | ppl: 10.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,127
E00 step 000420/130350 (0.3%) | loss: 2.3899 | ppl: 10.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,179
E00 step 000430/130350 (0.3%) | loss: 2.3029 | ppl: 10.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,190
E00 step 000440/130350 (0.3%) | loss: 2.4439 | ppl: 11.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,114
E00 step 000450/130350 (0.3%) | loss: 2.5300 | ppl: 12.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,264
E00 step 000460/130350 (0.4%) | loss: 2.3549 | ppl: 10.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,137
E00 step 000470/130350 (0.4%) | loss: 2.1817 | ppl: 8.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,244
E00 step 000480/130350 (0.4%) | loss: 2.2704 | ppl: 9.7 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,804
E00 step 000490/130350 (0.4%) | loss: 2.1874 | ppl: 8.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,178
E00 step 000500/130350 (0.4%) | loss: 2.1343 | ppl: 8.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,207
E00 step 000510/130350 (0.4%) | loss: 2.1686 | ppl: 8.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,120
E00 step 000520/130350 (0.4%) | loss: 2.1701 | ppl: 8.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,176
E00 step 000530/130350 (0.4%) | loss: 1.9757 | ppl: 7.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,294
E00 step 000540/130350 (0.4%) | loss: 2.0853 | ppl: 8.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,079
E00 step 000550/130350 (0.4%) | loss: 2.1802 | ppl: 8.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,348
E00 step 000560/130350 (0.4%) | loss: 2.0359 | ppl: 7.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,096
E00 step 000570/130350 (0.4%) | loss: 1.9663 | ppl: 7.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,316
E00 step 000580/130350 (0.4%) | loss: 1.9011 | ppl: 6.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,927
E00 step 000590/130350 (0.5%) | loss: 1.9527 | ppl: 7.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,155
E00 step 000600/130350 (0.5%) | loss: 2.2102 | ppl: 9.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,280
E00 step 000610/130350 (0.5%) | loss: 1.9081 | ppl: 6.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,263
E00 step 000620/130350 (0.5%) | loss: 2.0276 | ppl: 7.6 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,361
E00 step 000630/130350 (0.5%) | loss: 2.0260 | ppl: 7.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,225
E00 step 000640/130350 (0.5%) | loss: 1.9907 | ppl: 7.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,214
E00 step 000650/130350 (0.5%) | loss: 2.0429 | ppl: 7.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,324
E00 step 000660/130350 (0.5%) | loss: 2.0339 | ppl: 7.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,201
E00 step 000670/130350 (0.5%) | loss: 1.9670 | ppl: 7.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,994
E00 step 000680/130350 (0.5%) | loss: 1.8653 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,205
E00 step 000690/130350 (0.5%) | loss: 1.8566 | ppl: 6.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,179
E00 step 000700/130350 (0.5%) | loss: 1.9306 | ppl: 6.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,121
E00 step 000710/130350 (0.5%) | loss: 1.9416 | ppl: 7.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,131
E00 step 000720/130350 (0.6%) | loss: 1.8818 | ppl: 6.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,125
E00 step 000730/130350 (0.6%) | loss: 1.9276 | ppl: 6.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,247
E00 step 000740/130350 (0.6%) | loss: 1.8936 | ppl: 6.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,150
E00 step 000750/130350 (0.6%) | loss: 1.9269 | ppl: 6.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,437
E00 step 000760/130350 (0.6%) | loss: 1.8798 | ppl: 6.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,094
E00 step 000770/130350 (0.6%) | loss: 1.8769 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,231
E00 step 000780/130350 (0.6%) | loss: 1.8719 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,137
E00 step 000790/130350 (0.6%) | loss: 1.8751 | ppl: 6.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,166
E00 step 000800/130350 (0.6%) | loss: 1.6612 | ppl: 5.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,182
E00 step 000810/130350 (0.6%) | loss: 1.7712 | ppl: 5.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,216
E00 step 000820/130350 (0.6%) | loss: 1.7939 | ppl: 6.0 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,394
E00 step 000830/130350 (0.6%) | loss: 1.6564 | ppl: 5.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,246
E00 step 000840/130350 (0.6%) | loss: 1.7127 | ppl: 5.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,145
E00 step 000850/130350 (0.7%) | loss: 1.7607 | ppl: 5.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,150
E00 step 000860/130350 (0.7%) | loss: 1.8444 | ppl: 6.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,241
Epoch   1 | Step    869 | Val loss: 1.5719 | Val ppl: 4.82 (best)
E01 step 000870/130350 (0.7%) | loss: 1.7779 | ppl: 5.9 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,477
E01 step 000880/130350 (0.7%) | loss: 1.6776 | ppl: 5.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,260
E01 step 000890/130350 (0.7%) | loss: 1.8371 | ppl: 6.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,939
E01 step 000900/130350 (0.7%) | loss: 1.6510 | ppl: 5.2 | lr: 4.00e-04 | dt: 501ms | tok/s: 261,363
E01 step 000910/130350 (0.7%) | loss: 1.6785 | ppl: 5.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,937
E01 step 000920/130350 (0.7%) | loss: 1.7702 | ppl: 5.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,039
E01 step 000930/130350 (0.7%) | loss: 1.7124 | ppl: 5.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,132
E01 step 000940/130350 (0.7%) | loss: 1.5402 | ppl: 4.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,171
E01 step 000950/130350 (0.7%) | loss: 1.5703 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,313
E01 step 000960/130350 (0.7%) | loss: 1.5757 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,216
E01 step 000970/130350 (0.7%) | loss: 1.5610 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,881
E01 step 000980/130350 (0.8%) | loss: 1.6215 | ppl: 5.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,104
E01 step 000990/130350 (0.8%) | loss: 1.6361 | ppl: 5.1 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,921
E01 step 001000/130350 (0.8%) | loss: 1.7505 | ppl: 5.8 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,799
E01 step 001010/130350 (0.8%) | loss: 1.7734 | ppl: 5.9 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,796
E01 step 001020/130350 (0.8%) | loss: 1.5917 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,866
E01 step 001030/130350 (0.8%) | loss: 1.6143 | ppl: 5.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,154
E01 step 001040/130350 (0.8%) | loss: 1.5017 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,919
E01 step 001050/130350 (0.8%) | loss: 1.7303 | ppl: 5.6 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,779
E01 step 001060/130350 (0.8%) | loss: 1.5778 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,206
E01 step 001070/130350 (0.8%) | loss: 1.5858 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,063
E01 step 001080/130350 (0.8%) | loss: 1.6128 | ppl: 5.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,048
E01 step 001090/130350 (0.8%) | loss: 1.6528 | ppl: 5.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,974
E01 step 001100/130350 (0.8%) | loss: 1.4584 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,991
E01 step 001110/130350 (0.9%) | loss: 1.5570 | ppl: 4.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,113
E01 step 001120/130350 (0.9%) | loss: 1.4196 | ppl: 4.1 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,714
E01 step 001130/130350 (0.9%) | loss: 1.5798 | ppl: 4.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,219
E01 step 001140/130350 (0.9%) | loss: 1.5677 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,121
E01 step 001150/130350 (0.9%) | loss: 1.4978 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,977
E01 step 001160/130350 (0.9%) | loss: 1.5420 | ppl: 4.7 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,205
E01 step 001170/130350 (0.9%) | loss: 1.4562 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,096
E01 step 001180/130350 (0.9%) | loss: 1.5106 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,954
E01 step 001190/130350 (0.9%) | loss: 1.3437 | ppl: 3.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,145
E01 step 001200/130350 (0.9%) | loss: 1.5672 | ppl: 4.8 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,187
E01 step 001210/130350 (0.9%) | loss: 1.6036 | ppl: 5.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,069
E01 step 001220/130350 (0.9%) | loss: 1.4503 | ppl: 4.3 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,266
E01 step 001230/130350 (0.9%) | loss: 1.5129 | ppl: 4.5 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,216
E01 step 001240/130350 (1.0%) | loss: 1.4840 | ppl: 4.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,110
E01 step 001250/130350 (1.0%) | loss: 1.4386 | ppl: 4.2 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,005
E01 step 001260/130350 (1.0%) | loss: 1.3670 | ppl: 3.9 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,192
E01 step 001270/130350 (1.0%) | loss: 1.2599 | ppl: 3.5 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,755
E01 step 001280/130350 (1.0%) | loss: 1.2763 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,214
E01 step 001290/130350 (1.0%) | loss: 1.3880 | ppl: 4.0 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,949
E01 step 001300/130350 (1.0%) | loss: 1.4838 | ppl: 4.4 | lr: 4.00e-04 | dt: 502ms | tok/s: 261,274
E01 step 001310/130350 (1.0%) | loss: 1.4465 | ppl: 4.2 | lr: 4.00e-04 | dt: 503ms | tok/s: 260,726
E01 step 001320/130350 (1.0%) | loss: 1.2925 | ppl: 3.6 | lr: 4.00e-04 | dt: 502ms | tok/s: 260,9302026-01-07 08:38:01,272 - nanochat.common - [32m[1mINFO[0m - Distributed world size: 1
